<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@7.3.67/css/materialdesignicons.min.css" rel="stylesheet"/>
    <link  href="https://cdn.jsdelivr.net/npm/vuetify@3.4.8/dist/vuetify.min.css" rel="stylesheet"/>
    
    <title>Project Waste Not</title>
</head>
<body>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@3.4.8/dist/vuetify.min.js"></script>
    
    
    <div id="app"></div>
    

    <script type="text/x-template" id="app-template">
        <v-app>
            <v-card
                class="mx-auto my-auto elevation-10"
                width="1000"
                append-icon="mdi-cube-outline"
            >
                <template v-slot:title>
                    Inventory
                </template>
                <v-card-text>
                    <v-sheet color="transparent" width="200px">
                        <v-text-field
                            v-model="productSearch"
                            label="Product search"
                            append-inner-icon="mdi-magnify"
                        />
                    </v-sheet>
                </v-card-text>
                <v-card-text>
                    <v-data-table
                        :headers="headers"
                        :items="items"
                        item-key="product"
                        :loading="loading"
                        :search="productSearch"
                        :custom-filter="filterItems"
                    >
                        <template #item.edit_available_quantity="{ item }">
                            <v-text-field
                                :key="item.id+'id'"
                                v-model="item.available_units"
                                prefix="Qty."
                                append-inner-icon="mdi-magnify"
                            />
                        </template>
                    </v-data-table>
                </v-card-text>
            </v-card>
        </v-app>
    </script>
    <script type="module">
        import { data } from "./items.js";
        import { headers } from "./headers.js";
        const { createApp, ref, computed, watch } = Vue
        const { createVuetify } = Vuetify
        
        const vuetify = createVuetify()

        const app = createApp({
            template: "#app-template", 
            setup() {
                const productSearch = ref('')
                const loading = ref(true)
                const editAvailableQuantity = ref('')
                const items = ref(data)

                setTimeout(() => loading.value = false, 2000);

                function filterItems (value, query, item) {
                    const item_code = item.columns['item_code'].toLowerCase()
                    const product = item.columns['product'].toLowerCase()
                    const category = item.columns['category'].toLowerCase()

                    const val = value.toLowerCase()
                    const q = query.toLowerCase()
                    
                    return val != null &&
                        q != null &&
                        typeof val === 'string' &&
                        (item_code.includes(q) ||
                        product.includes(q) ||
                        category.includes(q))
                }

                return { productSearch, headers, loading, filterItems, items }
            }
        })
        .use(vuetify)
        .mount("#app")
    </script>
</body>
</html>




